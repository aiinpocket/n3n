apiVersion: v1
kind: Secret
metadata:
  name: {{ include "n3n.fullname" . }}-secret
  labels:
    {{- include "n3n.labels" . | nindent 4 }}
type: Opaque
stringData:
  {{- if .Values.database.external }}
  DATABASE_PASSWORD: {{ .Values.database.password | quote }}
  {{- else }}
  DATABASE_PASSWORD: {{ .Values.postgresql.auth.password | quote }}
  {{- end }}
  {{- if .Values.redis.external }}
  REDIS_PASSWORD: {{ .Values.redis.password | quote }}
  {{- else if .Values.redis.auth.enabled }}
  REDIS_PASSWORD: {{ .Values.redis.auth.password | quote }}
  {{- else }}
  REDIS_PASSWORD: ""
  {{- end }}
  JWT_SECRET: {{ required "config.jwtSecret is required" .Values.config.jwtSecret | quote }}
  {{- if .Values.config.encryptionKey }}
  ENCRYPTION_KEY: {{ .Values.config.encryptionKey | quote }}
  {{- else }}
  ENCRYPTION_KEY: {{ .Values.config.jwtSecret | quote }}
  {{- end }}
